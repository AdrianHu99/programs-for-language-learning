This is the solution for module4 (hard).
